[{"fields": {"name": "Market Freeze", "admin_css": "body {\r\n  padding-top: 10px;\r\n}\r\n\r\n", "comments": "", "experimenter": 1, "admin_html": "<!DOCTYPE HTML>\r\n<html ng-app=\"Redwood\">\r\n  <head>\r\n\t\t<title>Market Freeze Admin</title>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/jquery/jquery.min.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/bootstrap/bootstrap-3.1.1.min.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/angular/angular-1.2.16.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodCore.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodHelpers.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodAdmin.js\"></script>\r\n\t\t<link type=\"text/css\" rel=\"stylesheet\" href=\"{{ STATIC_URL }}framework/css/bootstrap-3.1.1.min.css\"></link>\r\n\t\t<script type=\"text/javascript\">\r\n\t\t\t{{ js }}\r\n\t\t</script>\r\n\t\t<style type=\"text/css\">\r\n\t\t\t{{ css }}\r\n\t\t</style>\r\n\t</head>\r\n\t<body ng-controller=\"AdminCtrl\">\r\n\t\t<div class=\"container\">\r\n\r\n\t\t\t<div class=\"navbar navbar-default\" role=\"navigation\">\r\n\t\t\t\t<div class=\"container-fluid\">\r\n\t\t\t\t\t<div class=\"navbar-header\">\r\n\t\t\t\t\t\t<a class=\"navbar-brand\">Economics Experiment</a>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"collapse navbar-collapse\" id=\"admin-navbar-collapse\">\r\n\t\t\t\t\t\t<ul class=\"nav navbar-nav navbar-right\">\r\n\t\t\t\t\t\t\t<li><a>Administrator</a></li>\r\n\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"row\">\r\n\t\t\t\t<div class=\"col-md-3\">\r\n\t\t\t\t\t<div class=\"row\">\r\n\t\t\t\t\t\t<div class=\"col-md-12\">\r\n\t\t\t\t\t\t\t<div id=\"router-status\" class=\"alert alert-danger\"></div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"row\">\r\n\t\t\t\t\t\t<div class=\"col-md-12\">\r\n\t\t\t\t\t\t\t<div class=\"panel panel-default\">\r\n\t\t\t\t\t\t\t\t<div class=\"panel-body\">\r\n\t\t\t\t\t\t\t\t\t<ul class=\"nav nav-pills nav-stacked\">\r\n\t\t\t\t\t\t\t\t\t\t<li><a href=\"admin/payouts\" target=\"_blank\">View Payouts</a></li>\r\n\t\t\t\t\t\t\t\t\t\t<li><a id=\"archive\" href=\"#\">Archive Session</a></li>\r\n\t\t\t\t\t\t\t\t\t\t<li><a id=\"download\" href=\"admin/download\">Download Data</a></li>\r\n\t\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"col-md-9\">\r\n\t\t\t\t\t<div class=\"row\">\r\n\t\t\t\t\t\t<div class=\"col-md-12\">\r\n\t\t\t\t\t\t\t<h4>Subjects</h4>\r\n\t\t\t\t\t\t\t<table class=\"table table-bordered table-condensed table-striped\">\r\n\t\t\t\t\t\t\t\t<thead>\r\n\t\t\t\t\t\t\t\t<tr><th>ID</th><th>Group</th><th>Period</th><th style=\"width: 150px;\"></th></tr>\r\n\t\t\t\t\t\t\t\t</thead>\r\n\t\t\t\t\t\t\t\t<tbody id=\"subject-list\">\r\n\t\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"row\">\r\n\t\t\t\t\t\t<div class=\"col-md-8\">\r\n\t\t\t\t\t\t\t<button id=\"start-session\" class=\"btn btn-success\">Start Session</button>\r\n\t\t\t\t\t\t\t<button id=\"refresh-subjects\" class=\"btn btn-info\" title=\"Attempt recover by refreshing all subject browsers\">Recover Session</button>\r\n\t\t\t\t\t\t\t<button id=\"reset-session\" class=\"btn btn-danger\">Reset Session</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"col-md-4\">\r\n\t\t\t\t\t\t\t<div class=\"pull-right\">\r\n\t\t\t\t\t\t\t\t<button id=\"pause-session\" class=\"btn btn-warning\" disabled=\"disabled\">Pause</button>\r\n\t\t\t\t\t\t\t\t<button id=\"resume-session\" class=\"btn btn-primary\" disabled=\"disabled\">Resume</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<hr>\r\n\t\t\t<div class=\"row\">\r\n\t\t\t\t<div class=\"col-md-12\">\r\n\t\t\t\t\t<h4>Configuration</h4>\r\n\t\t\t\t\t<load-config></load-config>\r\n\t\t\t\t\t<div style=\"overflow: auto;\">\r\n\t\t\t\t\t\t<table class=\"config table table-bordered table-striped table-condensed\"></table>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</body>\r\n</html>\r\n", "admin_js": "Redwood.controller(\"AdminCtrl\", [\"$rootScope\", \"$scope\", \"Admin\", function($rootScope, $scope, ra) {\r\n\tvar Display = { //Display controller\r\n\r\n\t\tinitialize: function() {\r\n\t\t\t$(\"#start-session\").click(function () {\r\n\t\t\t\t$(\"#start-session\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\tra.trigger(\"start_session\");\r\n\t\t\t});\r\n\r\n\t\t\tra.on(\"start_session\", function() {\r\n\t\t\t\t$(\"#start-session\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\t$(\"#pause-session\").removeAttr(\"disabled\");\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#refresh-subjects\").click(function () {\r\n\t\t\t\t$(\"#refresh-subjects\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\tra.refreshSubjects().then(function() {\r\n\t\t\t\t\t$(\"#refresh-subjects\").removeAttr(\"disabled\");\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#reset-session\").click(function () {\r\n\t\t\t\tra.reset();\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#pause-session\").click(function () {\r\n\t\t\t\t$(\"#pause-session\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\tra.trigger(\"pause\");\r\n\t\t\t});\r\n\t\t\tra.on(\"pause\", function() {\r\n\t\t\t\t$(\"#pause-session\").attr(\"disabled\", \"disabled\");\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#resume-session\").click(function () {\r\n\t\t\t\t$(\"#resume-session\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\tra.trigger(\"resume\");\r\n\t\t\t});\r\n\t\t\tra.on(\"resume\", function() {\r\n\t\t\t\t$(\"#resume-session\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\t$(\"#pause-session\").removeAttr(\"disabled\");\r\n\t\t\t});\r\n\r\n\t\t\tra.on_subject_paused(function(userId) {\r\n\t\t\t\t$(\"#pause-session\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\t$(\"tr.subject-\" + userId).addClass(\"warning\"); //Display current period for each user\r\n\t\t\t\t$(\"tr.subject-\" + userId + \" :nth-child(4)\").text(\"Paused\"); //Display current period for each user\r\n\t\t\t});\r\n\r\n\t\t\tra.on_all_paused(function() {\r\n\t\t\t\t$(\"#resume-session\").removeAttr(\"disabled\");\r\n\t\t\t});\r\n\r\n\t\t\tra.on_subject_resumed(function(user) {\r\n\t\t\t\t$(\"tr.subject-\" + user).removeClass(\"warning\"); //Display current period for each user\r\n\t\t\t\t$(\"tr.subject-\" + user + \" :nth-child(4)\").text(\"\"); //Display current period for each user\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#archive\").click(function () {\r\n\t\t\t\tvar r = confirm(\"Are you sure you want to archive this session?\");\r\n\t\t\t\tif(r == true) {\r\n\t\t\t\t\tra.delete_session();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tra.on_router_connected(function(connected) { //Display router connection status\r\n\t\t\t\tvar status = $(\"#router-status\");\r\n\t\t\t\tif (connected) {\r\n\t\t\t\t\tstatus.text(\"Router Connected\");\r\n\t\t\t\t\tstatus.removeClass(\"alert-danger\");\r\n\t\t\t\t\tstatus.addClass(\"alert-success\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstatus.text(\"Router Disconnected\");\r\n\t\t\t\t\tstatus.removeClass(\"alert-success\");\r\n\t\t\t\t\tstatus.addClass(\"alert-danger\");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tra.on_set_period(function(user, period) {\r\n\t\t\t\t$(\"tr.subject-\" + user + \" :nth-child(3)\").text(period); //Display current period for each user\r\n\t\t\t});\r\n\r\n\t\t\tra.on_set_group(function(user, group) {\r\n\t\t\t\t$(\"tr.subject-\" + user + \" :nth-child(2)\").text(group); //Display group for each user\r\n\t\t\t});\r\n\r\n\t\t\tra.on_register(function(user) { //Add a row to the table to each user\r\n\t\t\t\t$(\"#subject-list\").empty();\r\n\t\t\t\tfor(var i = 0, l = ra.subjects.length; i < l; i++) {\r\n\t\t\t\t\t$(\"#subject-list\").append($(\"<tr>\").addClass(\"subject-\" + ra.subjects[i].user_id).append(\r\n\t\t\t\t\t\t$(\"<td>\").text(ra.subjects[i].user_id).after(\r\n\t\t\t\t\t\t\t$(\"<td>\").text(0).after(\r\n\t\t\t\t\t\t\t\t$(\"<td>\").text(0).after(\r\n\t\t\t\t\t\t\t\t\t$(\"<td>\").text(\"\"))))));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tra.on_set_config(function(config) { //Display the config file\r\n\t\t\t\t$(\"table.config\").empty();\r\n\t\t\t\tvar a = $.csv.toArrays(config);\r\n\t\t\t\tfor (var i = 0; i < a.length; i++) {\r\n\t\t\t\t\tvar row = a[i];\r\n\t\t\t\t\tvar tr = $(\"<tr>\");\r\n\t\t\t\t\tfor (var j = 0; j < row.length; j++) {\r\n\t\t\t\t\t\tvar cell = row[j];\r\n\t\t\t\t\t\tvar td = $((i == 0 ? \"<th>\" : \"<td>\")).text(cell);\r\n\t\t\t\t\t\ttr.append(td);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$(\"table.config\").append(tr);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\r\n\tvar resetGroups = function() {\r\n\t\tvar config = ra.get_config(1, 0) || {};\r\n\t\tfor (var i = 0; i < ra.subjects.length; i++) { //set all subjects to group 1 (this is so that matching can be changed per period)\r\n\t\t\tif($.isArray(config.groups)) {\r\n\t\t\t\tfor(var groupId = 0; groupId < config.groups.length; groupId++) {\r\n\t\t\t\t\tif($.isArray(config.groups[groupId])) {\r\n\t\t\t\t\t\tif(config.groups[groupId].indexOf(parseInt(ra.subjects[i].user_id)) > -1) { //Nested group array\r\n\t\t\t\t\t\t\tra.set_group(groupId + 1, ra.subjects[i].user_id);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tra.set_group(1, ra.subjects[i].user_id);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tra.set_group(1, ra.subjects[i].user_id);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tDisplay.initialize();\r\n\r\n\tra.on_load(function () {\r\n\t\tresetGroups(); //Assign groups to users\r\n\t});\r\n\r\n\tra.on_register(function(user) { //Add a row to the table to each user\r\n\t\tresetGroups();\r\n\t});\r\n\r\n\tra.on(\"start_session\", function() {\r\n\t\tra.start_session();\r\n\t});\r\n\r\n\tra.on(\"pause\", function() {\r\n\t\tra.pause();\r\n\t});\r\n\r\n\tra.on(\"resume\", function() {\r\n\t\tra.resume();\r\n\t});\r\n\r\n}]);\r\n\r\n", "rt_js": ""}, "model": "expecon.experiment", "pk": 13}, {"fields": {"experiment": 13, "html": "{% load verbatim %}\r\n<!DOCTYPE HTML>\r\n<html ng-app=\"Redwood\">\r\n\t<head>\r\n\t\t<title>Wait</title>\r\n\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/jquery/jquery.min.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/bootstrap/bootstrap-3.1.1.min.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/angular/angular-1.2.16.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodCore.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodHelpers.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodSubject.js\"></script>\r\n\t\t<link type=\"text/css\" rel=\"stylesheet\" href=\"{{ STATIC_URL }}framework/css/bootstrap-3.1.1.min.css\"></link>\r\n\t\t<script type=\"text/javascript\">\r\n\t\t\t{{ js }}\r\n\t\t</script>\r\n\t\t<style type=\"text/css\">\r\n\t\t\t{{ css }}\r\n\t\t</style>\r\n\t</head>\r\n{% verbatim %}\r\n\t<body ng-controller=\"SubjectCtrl\">\r\n\t\t\r\n\t\t<div class=\"navbar navbar-fixed-top container\">\r\n\t\t\t<div class=\"navbar navbar-default\" style=\"margin-bottom: 0;\">\r\n\t\t\t\t<div class=\"navbar-brand\" href=\"#\">Economics Experiment</div>\r\n\t\t\t\t<ul class=\"nav navbar-nav\">\r\n\t\t\t\t\t<li class=\"active\">\r\n\t\t\t\t\t\t<a>User ID: <span>{{$root.user_id}}</span></a>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div class=\"container\">\r\n\t\t\t<div class=\"row\">\r\n\t\t\t\t<div class=\"col-lg-12\">\r\n\t\t\t\t\tPlease wait for experiment to start...\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</body>\r\n{% endverbatim %}\r\n</html>\r\n\r\n", "name": "Wait", "css": "body {\r\n  padding-top: 10px;\r\n}\r\n\r\n", "js": "Redwood.controller(\"SubjectCtrl\", [\"$rootScope\", \"$scope\", \"RedwoodSubject\", function($rootScope, $scope, rs) {\r\n\trs.on_load(function() {\r\n\t\trs.next_period();\r\n\t});\r\n}]);\r\n\r\n"}, "model": "expecon.page", "pk": 58}, {"fields": {"experiment": 13, "html": "{% load verbatim %}\r\n<!DOCTYPE HTML>\r\n<html ng-app=\"Redwood\">\r\n\t<head>\r\n\t\t<title>Start</title>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/jquery/jquery.min.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/bootstrap/bootstrap-3.1.1.min.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/angular/angular-1.2.16.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodCore.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodHelpers.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodSubject.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/asyncCallManagerService.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/synchronizedStopWatch.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodSubject.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/flot/jquery.flot.js\"></script>\r\n\t\t<link type=\"text/css\" rel=\"stylesheet\" href=\"{{ STATIC_URL }}framework/css/bootstrap-3.1.1.min.css\"></link>\r\n\t\t<script type=\"text/javascript\">\r\n\t\t\t{{ js }}\r\n\t\t</script>\r\n\t\t<style type=\"text/css\">\r\n\t\t\t{{ css }}\r\n\t\t</style>\r\n\t</head>\r\n{% verbatim %}\r\n\t<body ng-controller=\"SubjectCtrl\">\r\n\t\t\r\n\t\t<div class=\"navbar navbar-fixed-top container\">\r\n\t\t\t<div class=\"navbar navbar-default\" style=\"margin-bottom: 0;\">\r\n\t\t\t\t<div class=\"navbar-brand\" href=\"#\">Economics Experiment</div>\r\n\t\t\t\t<ul class=\"nav navbar-nav\">\r\n\t\t\t\t\t<li class=\"active\">\r\n\t\t\t\t\t\t<a>User ID: <span>{{$root.user_id}}</span></a>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t</ul>\r\n\t\t\t\t<div class=\"navbar-right\">\r\n\t\t\t\t\t<div class=\"navbar-text\">Period: <span>{{$root.period}}</span></div>\r\n\t\t\t\t\t<div class=\"navbar-text\">Round: <span>{{round}} / {{rounds}}</span></div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div class=\"container\" style=\"margin-top: 45px;\">\r\n\t\t\t<div class=\"row\">\r\n\t\t\t\t<div class=\"col-lg-6\">\r\n\t\t\t\t\t<div class=\"box probability\">Probability of Forced Sale: <span style=\"float:right;\">{{probability}}%</span></div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"col-lg-6\">\r\n\t\t\t\t\t<div class=\"box probability\">Probability of Payout: <span style=\"float:right;\">{{100 - probability}}%</span></div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"col-lg-12\">\r\n\t\t\t\t\t<div class=\"box signal\">Signal: <span style=\"float:right;\">{{signal}}</span></div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"col-lg-4\">\r\n\t\t\t\t\t<div class=\"box\">Your Status:<span style=\"float:right;\" id=\"yourStatus\">not sold</span></div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"col-lg-4\">\r\n\t\t\t\t\t<div class=\"box\">Your PayOff:<span style=\"float:right;\" id=\"yourPayoff\">0</span></div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"col-lg-4\">\r\n\t\t\t\t\t<div class=\"box\">Market Status:<span style=\"float:right;\" id=\"marketStatus\">freed</span></div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"col-lg-12\">\r\n\t\t\t\t\t<div class=\"box\" id=\"msg\">Message: You can sell your market share or wait for the payout at the end</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"col-lg-12\" style=\"margin: 10px;\">\r\n\t\t\t\t\t<div id=\"marketPlot\" style=\"width:1000px; height:400px; margin: auto;\"></div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"col-lg-12\">\r\n\t\t\t\t\t<input id=\"sell\" class=\"button\" type=\"button\" value=\"Sell\" ng-click=\"sell()\">\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</body>\r\n{% endverbatim %}\r\n</html>\r\n\r\n", "name": "Start", "css": "body {\r\n  padding-top: 10px;\r\n}\r\n\r\n.button {\r\n  height: 100%;\r\n  width: 100%;\r\n}\r\n\r\n.button, .box {\r\n  padding: 2%;\r\n}\r\n\r\n.box {\r\n  border-radius: 5px;\r\n  color: white;\r\n  background: #66F;\r\n  margin-top: 10px;\r\n}\r\n\r\n#marketPlot {\r\n  margin: 10px;\r\n}\r\n\r\n* {\r\n  font-size: 20px;\r\n}\r\n", "js": "Redwood.controller('SubjectCtrl', ['$rootScope', '$scope', 'RedwoodSubject', 'SynchronizedStopWatch', function($rootScope, $scope, rs, stopwatch) {\r\n\r\n\trs.on_load(function() {\r\n/*\t========================================================================\r\n\t\tProgram Variables\r\n\t======================================================================== */\r\n\r\n\t\t$.extend($scope, rs.config);\r\n\t\tfor (var i in rs.config.grouping) {\r\n\t\t\tfor (var j in rs.config.grouping[i]) {\r\n\t\t\t\tif (rs.config.grouping[i][j] == rs.user_id) {\r\n\t\t\t\t\t$scope.group = parseInt(i);\r\n\t\t\t\t\t$scope.index = parseInt(j);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t$scope.state = 'NORMAL';\r\n\t\t$scope.opt = {\r\n\t\t\tyaxis : { min : 0, max : $scope.marketPrices[0] + 2 },\r\n\t\t\txaxis : { min : 0, max : 25, show : false },\r\n\t\t\tgrid : { markings: function (axes) {\r\n\t\t\t\tvar markings = [], value = Math.floor(axes.xaxis.min);\r\n\t\t\t\tif (value % 2 == 0) value -= 1;\r\n\t\t\t\tfor (var x = value; x <= axes.xaxis.max; x += 2)\r\n\t\t\t\t\tmarkings.push({ xaxis: { from: x, to: x + 1 } });\r\n\t\t\t\treturn markings;\r\n\t\t\t} }\r\n\t\t};\r\n\t\t$scope.data = [];\r\n\t\t$scope.soldBeforeYou = 0;\r\n\t\t$scope.playersWhoSold = [];\r\n\t\t$scope.numOfTimesFrozen = 0;\r\n\t\t$scope.probability = 50;\r\n\t\t$scope.signalCount = {good: 0, bad: 0};\r\n\t\tif ($scope.convention == 'signal') $('.probability').hide();\r\n\t\telse $('.signal').hide();\r\n\t\tif ($scope.convention != 'signal' && $.isArray($scope.eventProbabilities))\r\n\t\t\tif ($.isArray($scope.eventProbabilities[$scope.group])) {\r\n\t\t\t\tif ($.isArray($scope.eventProbabilities[$scope.group][$scope.index]))\r\n\t\t\t\t\t$scope.events = $scope.eventProbabilities[$scope.group][$scope.index];\r\n\t\t\t\telse\r\n\t\t\t\t\t$scope.events = $scope.eventProbabilities[$scope.group];\r\n\t\t\t} else $scope.events = $scope.eventProbabilities;\r\n\t\telse if ($scope.convention == 'signal' && $.isArray($scope.eventSignals)) {\r\n\t\t\tif ($.isArray($scope.eventSignals[$scope.group])) {\r\n\t\t\t\tif ($.isArray($scope.eventSignals[$scope.group][$scope.index]))\r\n\t\t\t\t\t$scope.events = $scope.eventSignals[$scope.group][$scope.index];\r\n\t\t\t\telse\r\n\t\t\t\t\t$scope.events = $scope.eventSignals[$scope.group];\r\n\t\t\t} else $scope.events = $scope.eventSignals;\r\n\t\t}\r\n\t\t\r\n/*\t========================================================================\r\n\t\tProgram Functions\r\n\t======================================================================== */\r\n\t\t\r\n\t\t$scope.sell = function () {\r\n\t\t\trs.trigger('sell', {group: $scope.group});\r\n\t\t};\r\n\t\t$scope.setupAxes = function (t) {\r\n            if (t > 20 && t > $scope.opt.xaxis.max - 20) {\r\n                $scope.opt.xaxis.max = t + 5;\r\n                $scope.opt.xaxis.min = t - 20;\r\n            }\r\n        };\r\n\t\t$scope.updatePlot = function (t) {\r\n\t\t\tvar value = $scope.marketPrices[0] ? $scope.marketPrices[0] : 0;\r\n\t\t\t$scope.data.push([t, value]);\r\n\t\t\t$scope.setupAxes(t);\r\n\t\t\t$.plot($('#marketPlot'), [{\r\n                label : 'Current price',\r\n                data : $scope.data\r\n            }], $scope.opt);\r\n\t\t};\r\n\t\t$scope.updateTable = function (t) {\r\n\t\t\t\r\n\t\t\tvar tickEvents = $scope.tickEvents;\r\n\t\t\tif (tickEvents.length > 0 && t >= tickEvents[0]) {\r\n\t\t\t\ttickEvents.shift();\r\n\t\t\t\tif ($scope.convention == 'signal') {\r\n\t\t\t\t\t$scope.signal = $scope.events.shift() == 0 ?\r\n\t\t\t\t\t\t\t\t\t$scope.signal = '+Good (+'+\r\n\t\t\t\t\t\t\t\t\t(++$scope.signalCount.good) +\r\n\t\t\t\t\t\t\t\t\t' / -' + $scope.signalCount.bad + ')' :\r\n\t\t\t\t\t\t\t\t\t$scope.signal = '-Bad (+'+\r\n\t\t\t\t\t\t\t\t\t$scope.signalCount.good +\r\n\t\t\t\t\t\t\t\t\t' / -' + (++$scope.signalCount.bad) + ')';\r\n\t\t\t\t\trs.trigger('update', {signal: $scope.signal});\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$scope.probability = $scope.events.shift();\r\n\t\t\t\t\trs.trigger('update', {probability: $scope.probability});\r\n\t\t\t\t}\r\n\t\t\t\t$('.probability, .signal')\r\n\t\t\t\t\t.animate({ opacity: 0.4 }, 250 )\r\n\t\t\t\t\t.animate({ opacity: 1 }, 250 );\r\n\t\t\t}\r\n        };\r\n\t\t\r\n/*\t========================================================================\r\n\t\tSending Messages\r\n\t======================================================================== */\r\n\t\t\r\n\t\t$scope.sell = function () {\r\n\t\t\trs.trigger('orderPending', {group: $scope.group});\r\n\t\t};\r\n\t\trs.on('orderPending', function (obj) {\r\n\t\t\tif ($scope.group != obj.group) return;\r\n\t\t\t$('#sell').attr('disabled', 'disabled');\r\n\t\t\t$('#msg').text('Message: Order pending...');\r\n\t\t\tif ($scope.immediateSale) {\r\n\t\t\t\tif ($scope.orderPending) rs.trigger('freezeMarket', {group: $scope.group});\r\n\t\t\t\telse rs.trigger('processOrder', {group: $scope.group});\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\trs.trigger('processOrder', {group: $scope.group});\r\n\t\t\t\t}, $scope.clearTime * 1000);\r\n\t\t\t}\r\n\t\t\t$scope.orderPending = true;\r\n\t\t});\r\n\t\trs.recv('orderPending', function (sender, obj) {\r\n\t\t\tif ($scope.group != obj.group) return;\r\n\t\t\t$('#msg').text('Message: Player '+sender+' placed an order');\r\n\t\t\tif ($scope.orderPending && $scope.maxNumOfFreezes != 'none' && $scope.numOfTimesFrozen < $scope.maxNumOfFreezes) rs.trigger('freezeMarket', {group: $scope.group});\r\n\t\t});\r\n\t\trs.on('processOrder', function (obj) {\r\n\t\t\tif ($scope.group != obj.group) return;\r\n\t\t\tif ($scope.marketFrozen) return;\r\n\t\t\t$scope.playerScore = $scope.marketPrices.shift();\r\n\t\t\tif ($scope.immediateSale) {\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t$scope.orderPending = false;\r\n\t\t\t\t}, $scope.clearTime * 1000);\r\n\t\t\t} else $scope.orderPending = false;\r\n\t\t\t$scope.playersWhoSold[rs.user_id] = true;\r\n\t\t\t$('#yourStatus').text('sold');\r\n\t\t\t$('#msg').text('Message: You sold your share for $' + $scope.playerScore);\r\n\t\t\t$('#yourPayoff').text($scope.playerScore);\r\n\t\t});\r\n\t\trs.recv('processOrder', function (sender, obj) {\r\n\t\t\tif ($scope.group != obj.group) return;\r\n\t\t\tif ($scope.marketFrozen) return;\r\n\t\t\tif (!$scope.playerScore) $scope.soldBeforeYou++;\r\n\t\t\t$scope.playersWhoSold[sender] = true;\r\n\t\t\t$('#msg').text('Message: Player '+sender+' sold her share for $' + $scope.marketPrices.shift());\r\n\t\t});\r\n\t\trs.on('freezeMarket', function (obj) {\r\n\t\t\tif ($scope.group != obj.group) return;\r\n\t\t\t$scope.marketFrozen = true;\r\n\t\t\t$scope.numOfTimesFrozen++; \r\n\t\t\t$('#sell').attr('disabled', 'disabled');\r\n\t\t\t$('#msg').text('Message: The market is locked!');\r\n\t\t\t$('#marketStatus').text('frozen');\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\trs.trigger('unfreezeMarket', {group: $scope.group});\r\n\t\t\t}, $scope.breakTime * 1000);\r\n\t\t});\r\n\t\trs.recv('freezeMarket', function (sender, obj) {\r\n\t\t\tif ($scope.group != obj.group) return;\r\n\t\t\t$scope.marketFrozen = true;\r\n\t\t\t$scope.numOfTimesFrozen++; \r\n\t\t\t$('#sell').attr('disabled', 'disabled');\r\n\t\t\t$('#msg').text('Message: The market is locked!');\r\n\t\t\t$('#marketStatus').text('frozen');\r\n\t\t});\r\n\t\trs.on('unfreezeMarket', function (obj) {\r\n\t\t\tif ($scope.group != obj.group) return;\r\n\t\t\t$scope.marketFrozen = false;\r\n\t\t\t$scope.orderPending = false;\r\n\t\t\t$('#msg').text('Message: The market is freed.');\r\n\t\t\t$('#marketStatus').text('freed');\r\n\t\t\tif (!$scope.playersWhoSold[rs.user_id]) $(\"#sell\").removeAttr('disabled');\r\n\t\t});\r\n\t\trs.recv('unfreezeMarket', function (sender, obj) {\r\n\t\t\tif ($scope.group != obj.group) return;\r\n\t\t\t$scope.marketFrozen = false;\r\n\t\t\t$scope.orderPending = false;\r\n\t\t\t$('#msg').text('Message: The market is freed.');\r\n\t\t\t$('#marketStatus').text('freed');\r\n\t\t\tif (!$scope.playersWhoSold[rs.user_id]) $(\"#sell\").removeAttr('disabled');\r\n\t\t});\r\n\t\trs.on('forcedSales', function (obj) {\r\n\t\t\tif ($scope.group != obj.group || obj.player != rs.user_id) return;\r\n\t\t\tif ($scope.playerScore) {\r\n\t\t\t\t$('#msg').text('Forced Sales: You sold before the end for $' + $scope.playerScore + ' and ' + $scope.soldBeforeYou + ' players sold before you did.');\r\n\t\t\t} else {\r\n\t\t\t\tif (rs.user_id == obj.player) $scope.playerScore = obj.score;\r\n\t\t\t\t$('#msg').text('Forced Sales: You were forced to sell for $' + $scope.playerScore + ' and ' + $scope.soldBeforeYou + ' players sold before you did.');\r\n\t\t\t}\r\n\t\t\t$('#yourPayoff').text($scope.playerScore);\r\n\t\t});\r\n\t\trs.recv('forcedSales', function (sender, obj) {\r\n\t\t\tif ($scope.group != obj.group || obj.player != rs.user_id) return;\r\n\t\t\tif ($scope.playerScore) {\r\n\t\t\t\t$('#msg').text('Forced Sales: You sold before the end for $' + $scope.playerScore + ' and ' + $scope.soldBeforeYou + ' players sold before you did.');\r\n\t\t\t} else {\r\n\t\t\t\tif (rs.user_id == obj.player) $scope.playerScore = obj.score;\r\n\t\t\t\t$('#msg').text('Forced Sales: You were forced to sell for $' + $scope.playerScore + ' and ' + $scope.soldBeforeYou + ' players sold before you did.');\r\n\t\t\t}\r\n\t\t\t$('#yourPayoff').text($scope.playerScore);\r\n\t\t});\r\n\t\trs.on('payoff', function (obj) {\r\n\t\t\tif ($scope.group != obj.group) return;\r\n\t\t\tif ($scope.playerScore) {\r\n\t\t\t\t$('#msg').text('Payout: You sold before the end for $' + $scope.playerScore + ' and ' + $scope.soldBeforeYou + ' players sold before you did.');\r\n\t\t\t} else {\r\n\t\t\t\t$scope.playerScore = $scope.payoff ? $scope.payoff : 20;\r\n\t\t\t\t$('#msg').text('Payout: You waited for the payout of $' + $scope.playerScore + ' and ' + $scope.soldBeforeYou + ' players sold before you did.');\r\n\t\t\t}\r\n\t\t\t$('#yourPayoff').text($scope.playerScore);\r\n\t\t});\r\n\t\r\n/*\t========================================================================\r\n\t\tRedwood Setup\r\n\t======================================================================== */\r\n\t\t\r\n\t\t$scope.round = 0; $scope.rounds = $scope.config.rounds || 1;\r\n\t\trs.trigger('next_round');\r\n\t\t\r\n\t\t// Timer, rounds, periods\r\n\t\tvar freq = 1;\r\n\t\tvar checkTime = function() {\r\n\t\t\t$scope.timeRemaining = 0;\r\n\t\t\t$scope.stopwatch = stopwatch.instance()\r\n\t\t\t\t.frequency(freq)\r\n\t\t\t\t.duration($scope.roundDuration + $scope.clearTime + 5)\r\n\t\t\t\t.onTick(function(tick, t) {\r\n\t\t\t\t\t// Program State machine\r\n\t\t\t\t\t$scope.timeRemaining = $scope.timeTotal - t;\r\n\t\t\t\t\tif ($scope.state == 'NORMAL') {\r\n\t\t\t\t\t\tvar i = 0, fakeTick = setInterval(function () {\r\n\t\t\t\t\t\t\t$scope.updatePlot((new Date().getTime() - $scope.roundStartTime) /  1000);\r\n\t\t\t\t\t\t\ti++; if (i > 9) clearInterval(fakeTick);\r\n\t\t\t\t\t\t}, 100);\r\n\t\t\t\t\t\t$scope.updateTable(tick/freq);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ($scope.timeRemaining <= 5 + $scope.clearTime && $scope.state == 'NORMAL') {\r\n\t\t\t\t\t\t$scope.state = 'WAIT';\r\n\t\t\t\t\t\t$('#sell').attr('disabled', 'disabled');\r\n\t\t\t\t\t\t$('#msg').text('Message: Ending soon ...');\r\n\t\t\t\t\t\t$('.box').css('background', 'red');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ($scope.timeRemaining <= 5 && $scope.state == 'WAIT') {\r\n\t\t\t\t\t\t$scope.state = 'ENDED';\r\n\t\t\t\t\t\tif ($scope.outcome == 'forced' && rs.user_id == rs.config.grouping[$scope.group][0]) {\r\n\t\t\t\t\t\t\tvar shuffleArray = function (o) { for(var j, x, i = o.length; i; j = Math.floor(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x); return o; }\r\n\t\t\t\t\t\t\tvar group = rs.config.grouping[$scope.group];\r\n\t\t\t\t\t\t\t$scope.marketPrices = shuffleArray($scope.marketPrices.slice(0, group.length));\r\n\t\t\t\t\t\t\tfor (var k = 0; k < group.length; k++) {\r\n\t\t\t\t\t\t\t\tvar user = group[k];\r\n\t\t\t\t\t\t\t\tif ($scope.playersWhoSold[user]) rs.trigger('forcedSales', {player: user, group: $scope.group});\r\n\t\t\t\t\t\t\t\telse rs.trigger('forcedSales', {score: $scope.marketPrices.shift(), player: user, group: $scope.group});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if ($scope.outcome == 'payoff') {\r\n\t\t\t\t\t\t\trs.trigger('payoff', {group: $scope.group});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.onComplete(function() {\r\n\t\t\t\t\t$scope.timeRemaining = 0;\r\n\t\t\t\t\t$scope.roundStartTime = null;\r\n\t\t\t\t\trs.trigger('next_round');\r\n\t\t\t\t}).start();\r\n\t\t\t$scope.timeTotal = $scope.stopwatch.getDurationInTicks() / freq;\r\n\t\t};\r\n\t\trs.on('next_period', function() { rs.add_points($scope.playerScore); rs.next_period(); });\r\n\t\trs.on('next_round', function () {\r\n\t\t\tif ($scope.rounds && $scope.round >= $scope.rounds) { rs.trigger('next_period'); return; }\r\n\t\t\t$scope.round++;\r\n\t\t\trs.synchronizationBarrier('round-' + $scope.round).then(function() {\r\n\t\t\t\t$scope.roundStartTime = (new Date()).getTime() / 1000;\r\n\t\t\t\trs.trigger('roundStartTime', $scope.roundStartTime);\r\n\t\t\t\tcheckTime();\r\n\t\t\t});\r\n\t\t});\r\n\t\trs.recv('next_round', function() {\r\n\t\t\tif ($scope.roundStartTime) {\r\n\t\t\t\t$scope.roundStartTime = null;\r\n\t\t\t\trs.trigger('next_round');\r\n\t\t\t}\r\n\t\t});\r\n\t\trs.on('roundStartTime', function(roundStartTime) {\r\n\t\t\t$scope.roundStartTime = Math.min(roundStartTime, $scope.roundStartTime);\r\n\t\t});\r\n\t\trs.recv('roundStartTime', function(sender, roundStartTime) {\r\n\t\t\t$scope.roundStartTime = Math.min(roundStartTime, $scope.roundStartTime);\r\n\t\t});\r\n\t});\r\n}]);\r\n\r\n"}, "model": "expecon.page", "pk": 59}, {"fields": {"experiment": 13, "html": "{% load verbatim %}\r\n<!DOCTYPE HTML>\r\n<html ng-app=\"Redwood\">\r\n\t<head>\r\n\t\t<title>Finish</title>\r\n\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/jquery/jquery.min.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/bootstrap/bootstrap-3.1.1.min.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/lib/angular/angular-1.2.16.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodCore.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodHelpers.js\"></script>\r\n\t\t<script type=\"text/javascript\" src=\"{{ STATIC_URL }}framework/js/redwoodSubject.js\"></script>\r\n\t\t<link type=\"text/css\" rel=\"stylesheet\" href=\"{{ STATIC_URL }}framework/css/bootstrap-3.1.1.min.css\"></link>\r\n\t\t<script type=\"text/javascript\">\r\n\t\t\t{{ js }}\r\n\t\t</script>\r\n\t\t<style type=\"text/css\">\r\n\t\t\t{{ css }}\r\n\t\t</style>\r\n\t</head>\r\n{% verbatim %}\r\n\t<body ng-controller=\"SubjectCtrl\">\r\n\t\t\r\n\t\t<div class=\"navbar navbar-fixed-top container\">\r\n\t\t\t<div class=\"navbar navbar-default\" style=\"margin-bottom: 0;\">\r\n\t\t\t\t<div class=\"navbar-brand\" href=\"#\">Economics Experiment</div>\r\n\t\t\t\t<ul class=\"nav navbar-nav\">\r\n\t\t\t\t\t<li class=\"active\">\r\n\t\t\t\t\t\t<a>User ID: <span>{{ $root.user_id }}</span></a>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div class=\"container\" style=\"margin-top: 45px;\">\r\n\t\t\t<table class=\"table table-bordered table-condensed\">\r\n\t\t\t\t<thead>\r\n\t\t\t\t\t<tr><th>Period</th><th>Points</th><th>Earnings</th></tr>\r\n\t\t\t\t</thead>\r\n\t\t\t\t<tbody id=\"results\">\r\n\t\t\t\t\t<tr ng-repeat=\"points in pointsByPeriod track by $index\">\r\n\t\t\t\t\t\t<td>{{ $index + 1 }}</td><td>{{ points | number:2 }}</td><td>${{ points | number:2 }}</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr class=\"warning\">\r\n\t\t\t\t\t\t<td>Average:</td><td>{{ ($root.totalPoints / ($root.period - 1) || 0) | number:2 }}</td><td>${{ ($root.totalPoints / ($root.period - 1) || 0) | number:2 }}</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr class=\"success\">\r\n\t\t\t\t\t\t<td>Total:</td><td>{{ $root.totalPoints | number:2 }}</td><td>${{ $root.totalPoints | number:2 }}</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</tbody>\r\n\t\t\t</table>\r\n\t\t</div>\r\n\t</body>\r\n{% endverbatim %}\r\n</html>\r\n\r\n", "name": "Finish", "css": "body {\r\n  padding-top: 10px;\r\n}\r\n\r\n", "js": "Redwood.controller(\"SubjectCtrl\", [\"$rootScope\", \"$scope\", \"RedwoodSubject\", function($rootScope, $scope, rs) {\r\n\trs.on_load(function() {\r\n\t\t$scope.pointsByPeriod = rs.subject[rs.user_id].points_by_period();\r\n\t\t$scope.pointsByPeriod.shift();\r\n\t});\r\n}]);\r\n\r\n"}, "model": "expecon.page", "pk": 60}]